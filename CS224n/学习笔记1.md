$$
\text { bank }=\left(\begin{array}{r}
0.286 \\
0.792 \\
-0.177 \\
-0.107 \\
0.109 \\
-0.549 \\
0.371
\end{array}\right)
$$

è¯å‘é‡**Word2vec**åˆç§°word embeddingæˆ–è€…word representation,ä¸Šé¢æ˜¯åˆ†å¸ƒå¼diostribution representation,ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„ä½ç½®å‘é‡ï¼Œæ¯ä¸€ä¸ªå•è¯éƒ½æœ‰ä¸€ä¸ªdistribution representation,æ„æˆäº†å‘é‡ç©ºé—´ã€‚

**Word2vec**æ˜¯ä¸€ä¸ªè¯å‘é‡å­¦ä¹ æ¡†æ¶

**ä¸»è¦æ€æƒ³**ï¼š



- æœ‰ä¸€å¤§ç°‡çš„æ–‡æœ¬
- æ¯ä¸€ä¸ªå•è¯åœ¨ä¸€ä¸ªç¡®å®šçš„è¯å…¸ä¸­ç”¨ä»¥è¯å‘é‡è¡¨ç¤º
- Go throughæ–‡æœ¬ä¸­çš„æ¯ä¸€ä¸ªä½ç½®ï¼Œè¿™ä¸ªæ–‡æœ¬æœ‰ä¸€ä¸ªä¸­å¿ƒå•è¯ c ä»¥åŠ context(â€œoutside å•è¯â€) o,è§‚å¯Ÿè¿™ä¸ªå•è¯å‘¨å›´çš„å•è¯ã€‚
- ä½¿ç”¨å•è¯ cä¸å•è¯ oçš„å•è¯å‘é‡çš„ç›¸ä¼¼æ€§æ¥è®¡ç®—ç»™å®šçš„ æ¦‚ç‡
- è°ƒæ•´è¿™ä¸ªå•è¯å‘é‡ï¼Œç›´åˆ°æœ€å¤§åŒ–è¿™ä¸ªæ¦‚ç‡

![img](https://img2018.cnblogs.com/blog/1346871/201904/1346871-20190428090748482-2118879432.png)

æˆ‘ä»¬éœ€è¦è®¡ç®—çš„æ˜¯ ğ‘ƒ(ğ‘¤ğ‘¡+ğ‘—|ğ‘¤ğ‘¡)P(wt+j|wt)ã€‚

æˆ‘ä»¬å¸Œæœ›çš„æ˜¯é€šè¿‡å‘¨å›´çš„å•è¯é¢„æµ‹å‡ºä¸­é—´çš„å•è¯ â€˜intoâ€™ ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¹å˜è¿™äº›é¢„æµ‹ï¼Œå¦‚æœæˆ‘ä»¬ä»è´å¶æ–¯çš„è§’åº¦çœ‹çš„è¯ï¼Œé‚£ä¹ˆå°±æ˜¯æˆ‘ä»¬å…ˆè®¡ç®—å‡ºå½“é‡åˆ° 'into' çš„æ—¶å€™ï¼Œå‘¨å›´æ¯ä¸ªå•è¯çš„æ¦‚ç‡ä½œä¸ºå…ˆéªŒï¼Œç„¶åå½“é‡åˆ°å‘¨å›´çš„å•è¯çš„æ—¶å€™ï¼Œç”¨åéªŒå°±å¯ä»¥ç®—å‡ºå•è¯æ˜¯ â€˜intoâ€™çš„æ¦‚ç‡ã€‚

**Word2vecçš„ç›®æ ‡å‡½æ•°å‡½æ•°**

å¯¹äºæ–‡æœ¬ä¸­çš„æ¯ä¸€ä¸ªä½ç½®ï¼Œ$t=1,.....,T$æ¥é¢„æµ‹ç”¨ä¸€ä¸ªå¤§å°ä¸ºmçš„çª—å£é¢„æµ‹'context words',å¯¹äºä¸­å¿ƒå•è¯$w_j$ï¼Œç›®æ ‡å‡½æ•°æ˜¯
$$
L(\theta)=\prod_{t=1}^{T} \prod_{-m \leq 0 \atop j \neq 0} P\left(w_{t+j} \mid w_{t} ; \theta\right)
$$
*m* è¡¨ç¤ºçª—å£çš„å¤§å°ï¼Œğ¿(ğœƒ)æ˜¯å…³äºæœ€ä¼˜åŒ– ğœƒçš„å‡½æ•°ï¼Œé‚£ä¹ˆ ğ½(ğœƒ)å°±æ˜¯ negative log ä¼¼ç„¶å‡½æ•°ã€‚ğœƒ æ°æ°å°±æ˜¯å•è¯å‘é‡

æŸå¤±å‡½æ•°è¡¨ç¤ºä¸º:
$$
J(\theta)=-\frac{1}{T} \log L(\theta)=-\frac{1}{T} \sum_{t=1}^{T} \sum_{-m \leq S \leq m \atop j \neq 0} \log P\left(w_{t+j} \mid w_{t} ; \theta\right)
$$
ä¸Šé¢çš„ ğ½(ğœƒ)æ˜¯æŸå¤±å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ç›®æ ‡å‡½æ•°ã€‚æœ€å°åŒ–ç›®æ ‡å‡½æ•°ç­‰ä»·äºæœ€å¤§åŒ–é¢„æµ‹çš„å‡†ç¡®ç‡ã€‚

**På‡½æ•°è®¡ç®—**

å¯¹äºæ¯ä¸ªwordï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§è¡¨ç°æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ï¼š

- $v_w$ when ğ‘¤ is a center word
- $u_w$ when ğ‘¤ is a context word

é‚£ä¹ˆå¯¹äºä¸­å¿ƒå•è¯ *c* äº context word *o*æ¥è¯´ï¼š
$$
P(o \mid c)=\frac{\exp \left(u_{o}^{T} v_{c}\right)}{\sum_{w \in V} \exp \left(u_{w}^{T} v_{c}\right)}
$$
å¯¹äºå‰é¢çš„ä¾‹å­æ¥è¯´å°±æ˜¯ï¼š$P\left(u_{\text {problems }} \mid v_{\text {into }}\right)$ short for $\mathrm{P}\left(\text {problems} \mid \text {into} ; u_{\text {problems }}, v_{\text {into}}, \theta\right)$

ä¸Šé¢å…¬å¼çš„è§£é‡Šï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯$u_{o}^{T} v_{c}$æ¥è¡¨ç¤ºæƒé‡çš„å¤§å°ã€‚ä¹Ÿå°±æ˜¯ä¸¤ä¸ªå•è¯é—´çš„å…³è”ç¨‹åº¦ï¼Œ$u_{o}^{T} v_{c}$è¶Šå¤§è¶Šç›¸å…³ï¼Œï¼ˆä»å‘é‡çš„è§’åº¦è§£é‡Šï¼‰ã€‚åˆ†æ¯æ˜¯æ‰€æœ‰çš„æƒ…å†µã€‚ç„¶åæ˜¯ä¸€ä¸ª ğ‘†ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥å‡½æ•°ï¼š
$$
\operatorname{softmax}\left(x_{i}\right)=\frac{\exp \left(x_{i}\right)}{\sum_{j=1}^{n} \exp \left(x_{j}\right)}=p_{i}
$$
**æ¢¯åº¦ä¸‹é™æœ€å°åŒ–æŸå¤±å‡½æ•°**

æˆ‘ä»¬çš„å‚æ•°åªæœ‰ä¸€ä¸ª ğœƒï¼Œä½†æ˜¯è¯·è®°ä½ ğœƒ åŒ…å«ä¸­å¿ƒå‘é‡ä¸ context wordå‘é‡ï¼Œæ‰€ä»¥æ˜¯ä¸¤æˆªé•¿ã€‚è¿™é‡Œæˆ‘ä»¬åªæ˜¯ç”¨ ğœƒ æ¥æ¨¡ç³Šçš„è¡¨ç¤ºä½ç½®å‚æ•°ï¼Œé‚£ä¹ˆ ğœƒ åˆ°åº•æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„å‚æ•°å‘¢ï¼Ÿåœ¨ CBOW ä¸ skip-gramä¸­å¯ä»¥ç†è§£ä¸ºä¸¤ä¸ªçŸ©é˜µã€‚è¿™ä¸ªåé¢å†è¯´ã€‚
$$
\theta=\left[\begin{array}{l}
v_{\text {aardvark }} \\
v_{a} \\
\vdots \\
v_{\text {zebra }} \\
u_{\text {aardvark }} \\
u_{a} \\
\vdots \\
u_{z e b r a}
\end{array}\right] \in \mathbb{R}^{2 d V}
$$


**Continuous Bag of Words Model (CBOW)**

![QQ20200624-225550](å­¦ä¹ ç¬”è®°1.assets/QQ20200624-225550.png)

**Skip-gram** 

è¯¥ç®—æ³•ä¸ CBOWçš„æ€è·¯ç›¸åã€‚æ˜¯é€šè¿‡ä¸­å¿ƒè¯é¢„æµ‹ä¸Šä¸‹æ–‡çš„å•è¯å‘é‡ï¼šæˆ‘ä»¬è¾“å…¥ç”¨ ğ‘¥ è¡¨ç¤º ï¼Œè¾“å‡ºç”¨ ğ‘¦(ğ‘—)æ¥è¡¨ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰ç›¸åŒçš„çŸ©é˜µ $\mathcal{V}$å’Œ $V$ã€‚è¯¥ç®—æ³•åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š

1. ä¸­å¿ƒå•è¯çš„ one-hotç¼–ç ï¼Œç”¨$x \in \mathbb{R}^{|V|}$æ¥è¡¨ç¤ºã€‚
2. äº§ç”Ÿå•è¯å‘é‡$v_{c}=V , x \in \mathbb{R}^{n}$
3. $z=\mathcal{U} v_{c}$
4.  softmaxå‡½æ•°$\hat{y}=\operatorname{softmax}(z)$ï¼Œè¿™é‡Œå‡è®¾$\hat{y}_{c-m}, \ldots, \hat{y}_{c-1}, \hat{y}_{c+1}, \ldots, \hat{y}_{c+m}$æ˜¯è§‚å¯Ÿåˆ°æ¯ä¸€ä¸ªæ–‡æœ¬å‘é‡çš„æ¦‚ç‡
5. æˆ‘ä»¬å¸Œæœ›çš„æ˜¯æˆ‘ä»¬äº§ç”Ÿçš„æ¦‚ç‡$\hat{y}_{c-m}, \ldots, \hat{y}_{c-1}, \hat{y}_{c+1}, \ldots, \hat{y}_{c+m}$ ä¸å®é™…çš„æ¦‚ç‡ $y^{(c-m)}, \ldots, y^{(c-1)}, y^{(c+1)}, \ldots, y^{(c+m)}$ç›¸ç­‰ã€‚å®é™…çš„æ¦‚ç‡å°±æ˜¯æ¯ä¸€ä¸ªå•è¯çš„ one-hotç¼–ç ã€‚



å®šä¹‰ç›®æ ‡å‡½æ•°ä»¥åŠæœ€å°åŒ–æŸå¤±å‡½æ•°ï¼š
$$
\begin{array}{l}
\qquad \begin{aligned}
J &=-\sum_{j=0, j \neq m}^{2 m} \log P\left(u_{c-m+j} \mid v_{c}\right) \\
&=\sum_{j=0, j \neq m}^{2 m} H\left(\hat{y}, y_{c-m+j}\right)
\end{aligned} \\
=-\log P\left(w_{c-m}, \ldots, w_{c-1}, w_{c+1}, \ldots, w_{c+m} \mid w_{c}\right) \\
=-\log \prod_{j=0, j \neq m}^{2 m} P\left(w_{c-m+j} \mid w_{c}\right) \\
=-\log \prod_{j=0, j \neq m}^{2 m} P\left(u_{c-m+j} \mid v_{c}\right) \\
=-\log \prod_{j=0, j \neq m}^{2 m} \frac{\exp \left(u_{C-m+f}^{T}\right)}{\sum k^{\prime} D_{k} \operatorname{lexp}\left(u_{k} T_{c_{c}}\right)} \\
=-\log \prod_{j=0, j \neq m}^{2 m} u_{c-m+j}^{T} v_{c}+2 m \log \sum_{k=1}^{|V|} \exp \left(u_{k}^{T} v_{c}\right)
\end{array}
$$




















